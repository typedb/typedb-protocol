// This Source Code Form is subject to the terms of the Mozilla Public
// License, v. 2.0. If a copy of the MPL was not distributed with this
// file, You can obtain one at https://mozilla.org/MPL/2.0/.

syntax = "proto3";

package typedb.protocol;

message Request {
  oneof request {
    Load load = 1;
    DatabaseManager database_manager = 2;
    Database database = 3;
    UserManager user_manager = 4;
    User user = 5;
  }

  message Load {}

  message DatabaseManager {
    oneof database_manager {
      All all = 1;
      Contains contains = 2;
      Get get = 3;
      GetUnrestricted get_unrestricted = 4;
      Create create = 5;
      CreateUnrestricted create_unrestricted = 6;
    }

    message All {}

    message Contains {
      string name = 1;
    }

    message Get {
      string name = 1;
    }

    message GetUnrestricted {
      string name = 1;
    }
    message Create {
      string name = 1;
    }

    message CreateUnrestricted {
      string name = 1;
    }
  }

  message Database {
    oneof database {
      Schema schema = 1;
      TypeSchema type_schema = 2;
      SchemaCommit schema_commit = 3;
      DataCommit data_commit = 4;
      Delete delete = 5;
    }

    message Schema {
      string name = 1;
    }

    message TypeSchema {
      string name = 1;
    }

    message SchemaCommit {
      string name = 1;
      bytes commit_record = 2;
    }

    message DataCommit {
      string name = 1;
      bytes commit_record = 2;
    }

    message Delete {
      string name = 1;
    }
  }

  message UserManager {
    oneof user_manager {
      All all = 1;
      Contains contains = 2;
      Get get = 3;
      Create create = 4;
    }

    message All {
      string accessor = 1;
    }

    message Contains {
      string name = 1;
      string accessor = 2;
    }

    message Get {
      string name = 1;
      string accessor = 2;
    }

    message Create {
      string name = 1;
      string password_hash = 2;
      string accessor = 3;
    }
  }

  message User {
    oneof user {
      Update update = 1;
      Delete delete = 2;
    }

    message Update {
      string name = 1;
      optional string name_update = 2;
      optional string password_hash_update = 3;
      string accessor = 4;
    }

    message Delete {
      string name = 1;
      string accessor = 2;
    }
  }
}
