// This Source Code Form is subject to the terms of the Mozilla Public
// License, v. 2.0. If a copy of the MPL was not distributed with this
// file, You can obtain one at https://mozilla.org/MPL/2.0/.

syntax = "proto3";

package typedb.protocol;

message Request {
  oneof request {
    Load load = 1;
    DatabaseManager database_manager = 2;
    DatabaseCommit database_commit = 3;
    UserManager user_manager = 4;
  }

  message Load {}

  message DatabaseManager {
    oneof database_manager {
      All all = 1;
      Get get = 2;
      GetUnrestricted get_unrestricted = 3;
      Create create = 4;
      CreateUnrestricted create_unrestricted = 5;
      Delete delete = 6;
    }

    message All {}
    message Get { string name = 1; }
    message GetUnrestricted { string name = 1; }
    message Create { string name = 1; }
    message CreateUnrestricted { string name = 1; }
    message Delete { string name = 1; }
  }

  message DatabaseCommit {
    oneof database_commit {
      SchemaCommit schema = 1;
      DataCommit data = 2;
    }

    message SchemaCommit {
      string name = 1;
      bytes commit_record = 2;
    }

    message DataCommit {
      string name = 1;
      bytes commit_record = 2;
    }
  }

  message UserManager {
    oneof user_manager {
      All all = 1;
      Get get = 2;
      Contains contains = 3;
      Create create = 4;
      Update update = 5;
      Delete delete = 6;
    }

    message All { string accessor = 1; }
    message Get { string name = 1; string accessor = 2; }
    message Contains { string name = 1; }
    message Create { bytes commit_record = 1; }
    message Update { bytes commit_record = 1; }
    message Delete { bytes commit_record = 1; }
  }
}

